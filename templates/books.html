{% extends "base.html" %}
{% block content %}
    <section id="search_for_book" class="container">
        <div class="center-align">
            <h3>Search for book in this database</h3>
            <div class="card">
                <div class="card-content">Not yet implemented</div>
            </div>
        </div>
    </section>

    <section id="popular" class="container">
        <div class="center-align">
            <h3>10 Most Popular Books</h3>
        </div>
        <!-- Code inspired by Materialize -->
        <div class="carousel carousel-slider">
            {% for best_book in best_books %}
                <div class="carousel-item" href="#{{ best_book.number }}!">
                    <div class="card center-align">
                        <div class="card-content row">
                            <div class="col s6">
                                <img src="{{ best_book.book.image }}">
                            </div>
                            <div class="col s6">
                                <h6>Number {{ best_book.number }}:</h6>
                                <p> {{ best_book.book.title }} <br>
                                    {{ best_book.book.author }}<br>
                                    {{ best_book.book.published_date }}<br><br>
                                    <i class="fas fa-star">{{ best_book.book.average_grade }}</i><br>
                                </p>
                            </div>
                        </div>
                        <div class="card-action">
                            <button type="submit" class="btn-large btn-red waves-effect waves-light">
                                Buy
                            </button>
                            <a href="/get_book/{{ best_book.book._id }}" class="btn-large btn-green waves-effect waves-light">
                                Book Details
                            </a>
                            <button type="submit" class="btn-large btn-green waves-effect waves-light" onclick="addOpinion('{{ best_book.book._id }}', '{{ best_book.book.title }}', 'popular')">
                                Add opinion
                            </button>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
        <!--
        <div class="middle">
            <i id="prev" class="fas fa-chevron-left"></i>
            <i id="next" class="fas fa-chevron-right"></i>
        </div>
        -->

    <!-- Modal Structure from Materialize -->
    <div id="modal" class="modal modal-fixed-footer">
        <div class="modal-content">
            <h4 id="modal_header"></h4>
            <form id="modal_form" method="POST" action="{{ url_for('add_opinion', return_to='books') }}">
                <div id="hidden_input"></div>
                <div class="input-field">
                    <label for="grade_m"></label>
                    <select id="grade_m" name="grade_m" class="validate">
                        <option value="" disabled selected>Grade book</option>
                        <option value="5">5</option>
                        <option value="4">4</option>
                        <option value="3">3</option>
                        <option value="2">2</option>
                        <option value="1">1</option>
                    </select>
                </div>
                <div>
                    <label for="review_m">Your review of the book</label>
                    <textarea id="review_m" name="review_m"></textarea>
                </div>
            </form>
        </div>
        <div id="modal_buttons" class="modal-footer"></div>
    </div>
    </section>

    <section id="categories">
        <div class="center-align">
            <h3>Most Popular in Category</h3>
            <div class="row">
                {% for category_group in category_groups %}
                    <div class="col s6 m3">
                        <div class = "card-panel bgr-{{ category_group.colour }}" >
                            <form method="POST" action="{{ url_for('get_books') }}">
                                <input type="hidden" name="category" value="{{ category_group.group_name }}"> 
                                <button type="submit" class="btn-small bgr-black text-light" onclick="moveTo()">
                                    {{ category_group.group_name }}
                                </button>
                            </form>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>

        <div id="search_category">
            {% if contains_category==1 %}
                <div class="center-align">
                    <h3>Popular in Category {{category}}:</h3>
                </div>
                <div class="row">
                    {% for category_book in category_books %}
                        <div class="col s12 m6 xl4">
                            <div class="card medium center-align">
                                <div class="card-content">
                                    <img src="{{ category_book.image }}">
                                    <h6>{{ category_book.title }}</h6>
                                </div>
                                <div class="card-action">
                                    <div class="row">
                                        <div class="col s12">
                                            <a href="#" class="btn-small btn-red wave-effect wave-ligth">Buy</a>
                                        </div>
                                        <div class="col s6">
                                            <a href="/get_book/{{ category_book._id }}" class="btn-small btn-green waves-effect waves-light">
                                                    More
                                            </a>
                                        </div>
                                        <div class="col s6">
                                            <button type="submit" class="btn-small btn-green waves-effect waves-light" onclick="addOpinion('{{ category_book._id  }}', '{{ category_book.title }}', 'search_category')">
                                                Add opinion
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
    </section>  
    

    {% for book in best_books %}
        {{ book.book.title }}<br>
    {% endfor %}
    {{ contains_category }}
    {% for book in category_books %}
        {{ book.title }}<br>
    {% endfor %}
    
    {% if session.username %}
        <div id="book" class="row">
            <div class="center-align">
                <h2>Add book</h2>
            </div>
            <div>
                <div class="col s12 m10 offset-m1">
                    <div class="card">
                        <div class="card-content">
                            <div class="center-align">
                                <p>Search in ... for a book you want to add to this site</p>
                            </div>
                            <div class="row">
                                <form id="title_form" onsubmit="searchTitle({{category_groups}}); return false">
                                    <div class="input-field col s12 m7">
                                        <input id="search_title" name="search_title" placeholder="Full title or part of title" type="text" maxlength="30"
                                            class="validate" required>
                                    </div>
                                    <div class="col s12 m5">
                                        <button type="submit" class="btn-large btn-grey waves-effect waves-light">
                                            <i class="fas fa-search"></i>  Title 
                                        </button>
                                    </div>
                                </form>
                                <form id="author_form" onsubmit="searchAuthor({{ category_groups }}); return false">
                                    <div class="input-field col s12 m7">
                                        <input id="search_author" name="search_author" placeholder="Authors full name or part of name" maxlength="30"
                                            type="text" class="validate" required>
                                    </div>
                                    <div class="col s12 m5">
                                        <button type="submit" class="btn-large btn-grey waves-effect waves-light">
                                            <i class="fas fa-search"></i>  Author
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="search_results" class="row"></div>
        <div id="add_book"></div>
    {% endif %}
  <div class="row">
        <div class="center-align">
            <h2>Add Book</h2>
        </div>
        <div>
            <p>Choose category group for the book before it is added to the site. Book information below.</p>
        </div>
        <div class="col s12 m10 offset-m1">
            <div class="card">
                <div class="card-content bgr-white">
                    <form>
                        <div class="input-field col s12">
                                <label for="title">Title:</label>
                                <input id="title" name="title" type="text" value="Harry Potter and international relations" readonly>
                        </div>
                        <div class="center-align">
                            <img src="http://books.google.com/books/content?id=DKcWE3WXoj8C&printsec=frontcover&img=1&zoom=1&edge=curl&source=gbs_api" 
                                alt="Picture of book cover">
                        </div>
                        <div class="col s12">
                                <label for="category">Category/ies:</label>
                                <input id="category" name="category" type="text" value="Historical" readonly>
                        </div>
                        <div class="col s12">
                            <label for="category_group"></label>
                            <select id="category_group" name="category_group" class="validate" required>
                                <option value="" disabled selected>Choose Category Group</option>
                                {% for group in category_groups %}
                                    <option value="{{ group.group_name}}">{{ group.group_name}}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="col s12">
                            <label for="grade"></label>
                            <select id="grade" name="grade" class="validate">
                                <option value="" disabled selected>Grade book</option>
                                <option value="5">5</option>
                                <option value="4">4</option>
                                <option value="3">3</option>
                                <option value="2">2</option>
                                <option value="1">1</option>
                            </select>
                        </div>
                        <div class="col s12">
                                <label for="review">Your review of the book</label>
                                <textarea id="review" name="review"></textarea>
                        </div>
                        <div class="row">
                            <div class="col s12 center-align">
                                <a href="{{url_for('get_books')}}" class="btn-large btn-red waves-effect waves-light">
                                    Cancel <i class="fas fa-times-circle right"></i>
                                </a>
                                <button type="submit" class="btn-large btn-green waves-effect waves-light">
                                    Add <i class="fas fa-plus-square right"></i>
                                </button>
                            </div>
                        </div>    
                        <div class="center-align section">
                            <h5>Book Information:</h5>
                        </div>
                        <div class="row">
                            <div class="col s12">
                                <label for="author">Author/s:</label>
                                <textarea id="author" name="author" class="materialize-textarea" maxlength="200" readonly
                                    >Daniel H Nexon . Iver B. Neumann</textarea>
                            </div>
                            <div class="col s12">
                                <label for="country">Country:</label>
                                <input id="country" name="country" type="text" value="USA" readonly>
                            </div>
                            <div class="col s12">
                                <label for="publish_date">Published Date</label>
                                <input id="publish_date" name="publish_date" value="2006-12-14" type="text" readonly>
                            </div>
                            <div class="col s12">
                                <label for="isbn">ISBN:</label>
                                <input id="isbn" name="isbn" type="text" value="9780742539587" readonly>
                            </div>
                            <div class="col s12">
                                <label for="description">Description:</label>
                                <textarea id="description" name="description" class="materialize-textarea" readonly
                                    >Drawing on a range of historical and sociological sources, this work shows how aspects of Harry's world contain aspects of our own. It also includes chapters on the political economy of the franchise, and on the problems of studying popular culture</textarea>
                            </div>
                            <div class="col s12">
                                <label for="image_link">Image Link:</label>
                                <textarea id="image_link" name="image_link" class="materialize-textarea" readonly
                                    >http://books.google.com/books/content?id=DKcWE3WXoj8C&printsec=frontcover&img=1&zoom=1&edge=curl&source=gbs_api</textarea>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
   
    

{% endblock %}